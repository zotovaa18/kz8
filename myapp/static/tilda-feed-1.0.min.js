function t_feed_init(recid,opts){window.tFeedPosts={},t_feed_createObjWithPosts();var rec=document.querySelector("#rec"+recid);if(rec){var records=document.querySelector("#allrecords"),feed=rec.querySelector(".js-feed");if(feed){var preloader=rec.querySelector(".js-feed-preloader"),gridType=feed.getAttribute("data-feed-grid-type"),pageMode=records.getAttribute("data-tilda-mode"),panelFeed;if(opts.isPublishedPage="edit"!==pageMode&&"preview"!==pageMode,opts.btnText&&opts.amountOfPosts||opts.btnAllPosts.text)if("side-panel"===gridType)rec.querySelector(".t-feed__feed-wrapper").insertAdjacentHTML("beforeend",t_feed_drawBtnsContainer(opts));else feed.insertAdjacentHTML("beforeend",t_feed_drawBtnsContainer(opts));"y"!==window.lazy&&"yes"!==records.getAttribute("data-tilda-lazy")||t_feed_onFuncLoad("t_lazyload_update",(function(){t_lazyload_update()})),setTimeout((function(){preloader&&preloader.classList.remove("t-feed__post-preloader__container_hidden")}),1500),t_feed_showLoadersForPostsList(recid),-1!=window.location.hash.indexOf("#!/tfeeds")?t_feed_loadPosts(recid,opts,1,!1,t_feed_loadPartPosts):"side-panel"===gridType?t_feed_loadPanelPosts(recid,opts):t_feed_loadPosts(recid,opts,1,!1),t_feed_showMore(recid,opts),"col"!=feed.getAttribute("data-feed-grid-type")&&"slider"!=feed.getAttribute("data-feed-grid-type")||(window.addEventListener("resize",t_throttle((function(){t_feed_unifyColHeights(recid,opts)}),200)),"function"==typeof window.jQuery?$("#rec"+recid).find(".t-feed").bind("displayChanged",(function(){t_feed_unifyColHeights(recid,opts)})):rec.querySelector(".t-feed").addEventListener("displayChanged",(function(){t_feed_unifyColHeights(recid,opts)}))),window.onpopstate=function(){var body=document.body;if(body.classList.remove("t-zoomer__show"),body.classList.remove("t-zoomer__show_fixed"),null!==window.history.state){var obj=window.history.state.obj,post=window.history.state.post;t_feed_workPostPopup(recid,obj,post,post.uid,opts)}else body.classList.contains("t-body_popupshowed")&&t_feed_closePopup(recid,opts,window.location.href)}}}}function t_feed_loadPartPosts(recid,opts,slice){var rec=document.querySelector("#rec"+recid),switchers=rec.querySelectorAll(".js-feed-parts-switcher");if(Array.prototype.forEach.call(switchers,(function(switcher){var hashArr=decodeURI(window.location.hash).split("/"),isPartTitle=switcher.getAttribute("data-feedpart-title")==hashArr[hashArr.length-1],isUid=switcher.closest(".js-feed").getAttribute("data-feed-uid")==hashArr[hashArr.length-3];if(isPartTitle&&isUid){var feedpartuid=switcher.getAttribute("data-feedpart-uid");opts.feeduid=opts.feeduid.split("-")[0]+"-"+feedpartuid,rec.querySelector(".t-active").classList.remove("t-active"),switcher.classList.add("t-active")}})),window.tFeedPosts[recid].switcher=!0,window.tFeedPosts[recid].count=0,t_feed_loadPosts(recid,opts,slice,!1),-1!=window.location.href.indexOf("#!/tfeeds")){var hashArr=decodeURI(window.location.hash).split("/"),uid=hashArr[hashArr.length-3],feed=document.querySelector('.js-feed[data-feed-uid="'+uid+'"]'),offset=feed?feed.getBoundingClientRect():0,offsetTop;t_feed_scrollToFeed(feed,void 0!==offset?offset.top+window.pageYOffset:0)}}function t_feed_scrollToFeed(feed,offsetTop){var top=void 0!==offsetTop&&feed&&void 0!==feed.getBoundingClientRect()?offsetTop-100:0,isIE=!!document.documentMode,isSafari=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),safariMajorVersion=0;isSafari&&null!==(safariMajorVersion=navigator.appVersion.match(/Version\/(\d+)\.(\d+)\.?(\d+)? Safari/))&&(safariMajorVersion=parseInt(safariMajorVersion[1],10)),isIE||isSafari&&safariMajorVersion<=14?window.scrollTo(0,top):window.scrollTo({top:top,behavior:"smooth"})}function t_feed_createObjWithPosts(){var feeds=document.querySelectorAll(".js-feed");Array.prototype.forEach.call(feeds,(function(feed){var id=feed.getAttribute("data-feed-recid");window.tFeedPosts[id]={},void 0!==window.tFeedPosts[id]&&(window.tFeedPosts[id].count=0,window.tFeedPosts[id].switcher=!1)}))}function t_feed_loadPosts(recid,opts,slice,showmore,callback){var rec=document.querySelector("#rec"+recid),records=document.querySelector(".t-records"),btnShowMore=document.querySelector(".js-feed-btn-show-more"),isFirstSlice=!slice||1===parseInt(slice),dataObj=t_feed_createDataObjForRequest(recid,opts,isFirstSlice,slice),apiUrl="https://feeds.tildacdn.com/api/getfeed/";opts.isPublishedPage||(dataObj.projectid=records.getAttribute("data-tilda-project-id"),apiUrl="https://tilda.cc/projects/feeds/getfeed/"),btnShowMore&&(btnShowMore.style.pointerEvents="none",btnShowMore.style.opacity="0.7");var ts=Date.now(),t_feed__serializeData=function(obj,prefix){var str=[];for(var property in obj)if(Object.prototype.hasOwnProperty.call(obj,property)){var key=prefix?prefix+"["+property+"]":property,value=obj[property];"{}"!==JSON.stringify(value)&&str.push(null!==value&&"object"==typeof value?t_feed__serializeData(value,key):encodeURIComponent(key)+"="+encodeURIComponent(value))}return str.join("&")},request=new XMLHttpRequest;request.open("GET",apiUrl+"?"+t_feed__serializeData(dataObj),!0),request.timeout=25e3,request.onload=function(){if(this.status>=200&&this.status<400){var preloader=rec.querySelector(".js-feed-preloader"),container=rec.querySelector(".js-feed-container");if(""===request.response)return;try{var obj=JSON.parse(request.response)}catch(e){null!==preloader.parentNode&&preloader.parentNode.removeChild(preloader),container.insertAdjacentHTML("beforeend",t_feed_drawErrorBox(opts,request.response))}if("object"!=typeof obj)return;"error"in JSON.parse(request.response)&&setTimeout((function(){null!==preloader.parentNode&&preloader.parentNode.removeChild(preloader),container.insertAdjacentHTML("beforeend",t_feed_drawErrorBox(opts,JSON.parse(request.response).error))}),500);var feed=rec.querySelector(".js-feed");if(feed&&feed.setAttribute("data-feed-uid",obj.feeduid),window.tFeedPosts[recid]||(window.tFeedPosts[recid]={}),window.tFeedPosts[recid].lang=obj.feedlang,clearTimeout(rec.getAttribute("data-preloader-timeout")),preloader&&null!==preloader.parentNode&&preloader.parentNode.removeChild(preloader),isFirstSlice&&container&&(container.innerHTML=""),void 0!==obj.posts){var slice=parseInt(obj.slice,10),total=parseInt(obj.total,10);if(slice<total||slice===total)t_feed_generatePosts(obj,obj.posts,recid,opts,showmore);else if(void 0!==obj.posts&&0===obj.posts.length){var loadPostsEvent;return container.querySelector(".js-feed-error-msg")||container.insertAdjacentHTML("beforeend",t_feed_drawEmptyMessage(opts,recid)),container.setAttribute("data-slider-totalslides",0),(loadPostsEvent=document.createEvent("Event")).initEvent("feedsLoadPosts",!0,!0),void container.dispatchEvent(loadPostsEvent)}var switchers=rec.querySelectorAll(".js-feed-parts-switcher");0!==obj.posts.length&&obj.parts&&obj.parts.length>1&&0===switchers.length&&!opts.hideFeedParts&&t_feed_addFeedParts(recid,opts,obj.parts,obj.feeduid),container.setAttribute("data-slider-totalslides",total);var loadSlideEvent=document.createEvent("Event");loadSlideEvent.initEvent("feedsLoadSlide",!0,!0),container.dispatchEvent(loadSlideEvent)}void 0!==callback&&callback(recid,opts,slice,showmore);var posts=rec.querySelectorAll(".t-feed__post"),loadPostsEvent;if(Array.prototype.forEach.call(posts,(function(post){post.classList.remove("t-feed__post_hidden")})),btnShowMore&&(btnShowMore.style.pointerEvents="inherit",btnShowMore.style.opacity="1"),isFirstSlice&&container.classList.contains("t-slds__items-wrapper"))(loadPostsEvent=document.createEvent("Event")).initEvent("feedsLoadPosts",!0,!0),container.dispatchEvent(loadPostsEvent),container.setAttribute("data-feeds-posts-loaded","true");t_feed_displayButtons(recid,obj.nextslice,(obj.posts||[]).length);var tildaLazy=document.querySelector("#allrecords").getAttribute("data-tilda-lazy");"y"!==window.lazy&&"yes"!==tildaLazy||t_onFuncLoad("t_lazyload_update",(function(){t_lazyload_update()}))}},request.onerror=function(xhr){var ts_delta=Date.now()-ts;0==xhr.status&&ts_delta<100&&0!==xhr.readyState&&alert("Request error (get posts). Please check internet connection...")},request.send()}function t_feed_loadPanelPosts(recid,opts){var feeds=JSON.parse(localStorage.getItem("tFeeds"));feeds&&feeds.isEverLoaded&&setTimeout((function(){t_feed_loadPosts(recid,opts,1,!1)}),3e3)}function t_feed_createDataObjForRequest(recid,opts,isFirstSlice,slice){var size=opts.amountOfPosts,currentDate=Date.now(),dateFilter=opts.dateFilter,obj={feeduid:opts.feeduid,recid:recid,c:currentDate,size:size,slice:slice,sort:{date:opts.reverse},filters:{date:{}}};return"all"===dateFilter?obj.filters.date="":obj.filters.date[dateFilter]="now",slice&&(obj.slice=slice),isFirstSlice&&(obj.getparts=!0),obj}function t_feed_displayButtons(recid,nextslice,arrLength){var rec=document.querySelector("#rec"+recid),btnsWrapper=rec.querySelector(".t-feed__buttons-wrapper"),btnShowMore=rec.querySelector(".js-feed-btn-show-more"),btnShowAll=rec.querySelector(".js-feed-btn-show-all-posts");btnsWrapper&&(btnsWrapper.classList.remove("t-feed__buttons-wrapper_hidden"),btnShowMore&&(btnShowMore.style.display=void 0===nextslice?"none":"inline-block"),btnShowAll&&(btnShowAll.style.display=0===arrLength?"none":"inline-block"))}function t_feed_generatePosts(obj,feedArr,recid,opts,showmore){var rec=document.querySelector("#rec"+recid),feedContainer=rec.querySelector(".js-feed-container"),feed=rec.querySelector(".js-feed");if(feed){var gridType=feed.getAttribute("data-feed-grid-type"),feedHTML="";if(void 0!==feedArr)for(var i=0;i<feedArr.length;i++){var post=feedArr[i];"col"===gridType&&(feedHTML+=""+t_feed_drawSeparator(recid,opts)),feedHTML+=t_feed_drawWholePost(recid,post,opts,i),window.tFeedPosts[recid].count=window.tFeedPosts[recid].count+1,window.tFeedPosts[recid][post.uid]=post}var scrollTop=window.pageYOffset;if(feedContainer.insertAdjacentHTML("beforeend",feedHTML),window.scrollTop=scrollTop,t_feed_initPopup(recid,obj,window.tFeedPosts,opts),t_feed_unifyColHeights(recid,opts),void 0!==document.fonts?void 0!==document.fonts.ready&&document.fonts.ready.then((function(){setTimeout((function(){t_feed_unifyColHeights(recid,opts)}),1e3)})):setTimeout((function(){t_feed_unifyColHeights(recid,opts)}),1e3),"y"!==window.lazy&&"yes"!==document.querySelector("#allrecords").getAttribute("data-tilda-lazy")||t_feed_onFuncLoad("t_lazyload_update",(function(){t_lazyload_update()})),showmore&&"function"==typeof t_animate__startAnimation&&t_animate__startAnimation(),!opts.previewmode)try{addEditFieldEvents_new(recid)}catch(e){console.log(e)}}}function t_feed_drawSeparator(recid,opts){var str="";return window.tFeedPosts[recid].count>0&&window.tFeedPosts[recid].count%opts.blocksInRow==0&&(str+='<div class="t-clear t-feed__grid-separator" style="margin-bottom:'+opts.vindent+'"></div>'),str}function t_feed_showMore(recid,opts){var rec=document.querySelector("#rec"+recid),feed=rec.querySelector(".js-feed"),feedContainer=rec.querySelector(".js-feed-container"),gridType=feed.getAttribute("data-feed-grid-type"),btnShowMore=rec.querySelector(".js-feed-btn-show-more"),slice=1;null!==btnShowMore&&(btnShowMore.addEventListener("click",(function(){window.tFeedPosts[recid].switcher?slice=2:slice++,window.tFeedPosts[recid].switcher=!1,t_feed_loadPosts(recid,opts,slice,!0)})),opts.isHorizOnMob&&feedContainer.addEventListener("scroll",t_throttle((function(){var scrollWidth=feedContainer.scrollWidth,scrollLeft=feedContainer.scrollLeft,outerWidth;feedContainer.offsetWidth+scrollLeft+20>scrollWidth&&"none"!==getComputedStyle(btnShowMore).display&&btnShowMore.click()}),200))),"slider"===gridType&&feed.addEventListener("feedsLastSlide",(function(){window.tFeedPosts[recid].switcher?slice=2:slice++,window.tFeedPosts[recid].switcher=!1,t_feed_loadPosts(recid,opts,slice,!0)}))}function t_feed_initFeedParts(recid,opts){var rec=document.querySelector("#rec"+recid),feed=rec.querySelector(".js-feed"),feedContainer=rec.querySelector(".js-feed-container"),gridType=feed.getAttribute("data-feed-grid-type"),switchers=rec.querySelectorAll(".js-feed-parts-switcher");Array.prototype.forEach.call(switchers,(function(switcher){switcher.addEventListener("click",(function(){var self=this,btnAll=rec.querySelector(".t-feed__parts-switch-btn-all"),feedpartuid=this.getAttribute("data-feedpart-uid");if(rec.querySelector(".t-active").classList.remove("t-active"),this.classList.add("t-active"),opts.feeduid=opts.feeduid.split("-")[0]+"-"+feedpartuid,window.tFeedPosts[recid].switcher=!0,window.tFeedPosts[recid].count=0,btnAll.classList.contains("t-feed__parts-switch-btn_hide")&&!opts.showPartAll&&btnAll.classList.remove("t-feed__parts-switch-btn_hide"),t_feed_showLoadersForPostsList(recid),t_feed_loadPosts(recid,opts,1,!0),"slider"===gridType){var partsTotal=parseInt(feedContainer.getAttribute("data-slider-totalslides"),10),partsInRow=parseInt(feedContainer.getAttribute("data-slider-items-in-row"),10),partsCurPos=parseInt(feedContainer.getAttribute("data-slider-curr-pos"),10),arrowWrapperRight=feed.querySelector(".t-slds__arrow_wrapper-right"),arrowWrapperLeft=feed.querySelector(".t-slds__arrow_wrapper-left");feedContainer.setAttribute("data-slider-pos",1),partsTotal<=partsInRow&&arrowWrapperRight&&(arrowWrapperRight.style.display="none"),1===partsCurPos&&arrowWrapperLeft&&(arrowWrapperLeft.style.display="none"),t_onFuncLoad("t_slds__initFeedsSlider",(function(){t_slds__initFeedsSlider(recid,rec)}))}this.classList.contains("t-feed__parts-switch-btn-all")&&history.replaceState({},null,window.location.href.split("#")[0])}))}))}function t_feed_showLoadersForPostsList(recid){var rec=document.querySelector("#rec"+recid),posts=rec.querySelectorAll(".t-feed__post"),btnShowMore=rec.querySelector(".t-feed__show-more-btn"),preloader=rec.querySelector(".js-feed-preloader");if(Array.prototype.forEach.call(posts,(function(post){post.classList.add("t-feed__post_hidden")})),btnShowMore&&btnShowMore.classList.add("t-feed__show-more-btn_hidden"),preloader){var preloaderTimerId=setTimeout((function(){preloader.style.display="",preloader.style.opacity="0",preloader.style.transitionDuration="0.2s",preloader.style.opacity="1"}),1e3);rec.setAttribute("data-preloader-timeout",preloaderTimerId)}}function t_feed_drawWholePost(recid,post,opts,i){var rec=document.querySelector("#rec"+recid),records=document.querySelector(".t-records"),feed=rec.querySelector(".js-feed"),gridType=feed.getAttribute("data-feed-grid-type"),gridColModification=feed.getAttribute("data-feed-col-modification"),url=post.directlink?post.directlink:"#postpopup",target="_blank"==post.directtarget?'target="_blank"':"",alignClass="left"===opts.align?"t-align_left":"t-align_center",animClass=opts.itemsAnim&&opts.previewmode?"t-animate":"";records.getAttribute("data-blocks-animationoff")&&(animClass="");var animAttr=opts.itemsAnim?'data-animate-style="'+opts.itemsAnim+'" data-animate-chain="yes"':"",gridClass="",linkHTML_open=opts.previewmode?'<a href="'+url+'" '+target+' class="js-feed-post-link">':"",linkHTML_close=opts.previewmode?"</a>":"";"row"===gridType||"row-bigimg"===gridType?gridClass="t-col t-col_"+opts.colClass+" t-prefix_"+opts.prefixClass:"col"!==gridType&&"slider"!==gridType||(gridClass=opts.blocksClass+" "+alignClass);var activeSlideClass,sliderClass="slider"===gridType?"t-slds__item"+(0==i?" t-slds__item_active":""):"",slideIndex="slider"===gridType?"data-slide-index="+(window.tFeedPosts[recid].count+1):"",str="";return str+='<div class="js-feed-post t-feed__post t-feed__post_hidden t-item t-width '+sliderClass+" "+gridClass+" "+animClass+'" '+animAttr+' data-post-uid="'+post.uid+'" '+slideIndex+">","row"!==gridType||opts.separator.hideSeparator||(str+=""+t_feed_drawPostSeparatorLine(opts)),str+=linkHTML_open,"row"===gridType||"side-panel"===gridType?str+=""+t_feed_drawRowType(post,opts,recid):"col"===gridType?str+=""+t_feed_drawColType(post,opts,gridColModification,recid):"slider"===gridType?str+=""+t_feed_drawSliderType(post,opts,gridColModification,recid):"row-bigimg"===gridType&&(str+=""+t_feed_drawRowBigImgType(post,opts,recid)),str+=linkHTML_close,str+="</div>"}function t_feed_drawRowBigImgType(post,opts,recid){var titleMargin;titleMargin="aftertitle"===opts.imagePos&&("aftertitle"!==opts.datePos&&"aftertitle"!==opts.partsPos);var str="";return str+='<div class="t-feed__row-bigimg-grid__post-wrapper">',"beforetitle"==opts.imagePos&&(str+=""+t_feed_drawImageInRowBig(opts,post,"beforetitle",recid)),(opts.showDate&&"beforetitle"==opts.datePos||opts.showParts&&post.postparts.length>0&&"beforetitle"==opts.partsPos)&&(str+=""+t_feed_drawDateAndParts(opts,post,"beforetitle","col",recid)),str+=""+t_feed_drawTitle(opts,post,"medium",titleMargin),(opts.showDate&&"aftertitle"==opts.datePos||opts.showParts&&post.postparts.length>0&&"aftertitle"==opts.partsPos)&&(str+=""+t_feed_drawDateAndParts(opts,post,"aftertitle","col",recid)),"aftertitle"==opts.imagePos&&(str+=""+t_feed_drawImageInRowBig(opts,post,"aftertitle",recid)),opts.showShortDescr&&(str+='    <div class="t-feed__textwrapper">',str+=""+t_feed_drawDescr(opts,post,"medium"),str+="    </div>"),(opts.showDate&&"afterdescr"==opts.datePos||opts.showParts&&post.postparts.length>0&&"afterdescr"==opts.partsPos)&&(str+=""+t_feed_drawDateAndParts(opts,post,"afterdescr","col",recid)),"afterdescr"==opts.imagePos&&(str+=""+t_feed_drawImageInRowBig(opts,post,"afterdescr",recid)),str+="  </div>",str+="</div>"}function t_feed_drawRowType(post,opts,recid){var rec,gridType=document.querySelector("#rec"+recid).querySelector(".js-feed").getAttribute("data-feed-grid-type"),imageUrl=post.thumb?post.thumb:post.image,str="",paddingClass;"side-panel"===gridType?str+='<div class="t-feed__row-grid__post-wrapper t-feed__row-grid__post-wrapper_panel">':str+='<div class="t-feed__row-grid__post-wrapper'+(opts.separator.hideSeparator?" t-feed__row-grid__post-wrapper_padd-sm":"")+'">';if("video"===post.mediatype&&(-1===post.mediadata.indexOf("vimeo")&&-1===post.mediadata.indexOf(".mp4")||""!==post.thumb||(imageUrl="https://static.tildacdn.com/ffb6456b-781b-40e8-9517-ffb5225e8bcd/imgfish.jpg")),(""!==post.thumb||""!==post.image||"video"===post.mediatype)&&opts.showImage){var bgFieldAttr=post.uid?'bgimgfield="fe_img__'+post.uid+'"':"";str+='<div class="t-feed__post-imgwrapper"><div class="js-feed-post-image t-feed__post-bgimg t-bgimg" data-original="'+imageUrl+'" style="background-image:url('+t_feed_getLazyUrl(opts,imageUrl)+");width:"+opts.imageWidth+";height:"+opts.imageHeight+'" '+bgFieldAttr+"></div></div>"}return str+='<div class="t-feed__textwrapper">',(opts.showDate&&"beforetitle"==opts.datePosPs||opts.showParts&&post.postparts.length>0&&"beforetitle"==opts.partsPosPs)&&(str+=""+t_feed_drawDateAndParts(opts,post,"beforetitle","row",recid)),str+=""+t_feed_drawTitle(opts,post,"small",!1),(opts.showDate&&"aftertitle"==opts.datePosPs||opts.showParts&&post.postparts.length>0&&"aftertitle"==opts.partsPosPs)&&(str+=""+t_feed_drawDateAndParts(opts,post,"aftertitle","row",recid)),opts.showShortDescr&&(str+=""+t_feed_drawDescr(opts,post,"small")),(opts.showDate&&"afterdescr"==opts.datePosPs||opts.showParts&&post.postparts.length>0&&"afterdescr"==opts.partsPosPs)&&(str+=""+t_feed_drawDateAndParts(opts,post,"afterdescr","row",recid)),str+="</div></div></div>"}function t_feed_drawColType(post,opts,gridColModification,recid){var isBgModification="bg"===gridColModification,btnsAlignClass=opts.btnsAlign?" t-feed__col-grid__wrapper_align":"",paddingClass=isBgModification?" t-feed__col-grid__content":"",paddingAfterDescr=isBgModification&&"afterdescr"==opts.imagePosPs?" t-feed__col-grid__content_paddingtop":"",paddingSize=isBgModification?opts.colWithBg.paddingSize:"",marginBottom=isBgModification||"afterdescr"!=opts.imagePosPs?"":" t-feed__col-grid__content_marginbottom",style,str="";return str+='<div class="t-feed__col-grid__post-wrapper" '+(isBgModification?'style="'+t_feed_addStyleToColWithBg(opts)+'"':"")+">","beforetitle"!=opts.imagePosPs&&opts.imagePosPs||(str+=""+t_feed_drawImage(opts,post,"beforetitle",recid,isBgModification)),str+='<div class="t-feed__col-grid__wrapper'+btnsAlignClass+paddingClass+paddingAfterDescr+marginBottom+" "+paddingSize+'">',(opts.showDate&&"beforetitle"==opts.datePos||opts.showParts&&post.postparts.length>0&&"beforetitle"==opts.partsPos)&&(str+=""+t_feed_drawDateAndParts(opts,post,"beforetitle","col",recid)),str+='  <div class="t-feed__textwrapper">',str+=""+t_feed_drawTitle(opts,post,"small",!1),(opts.showDate&&"aftertitle"==opts.datePos||opts.showParts&&post.postparts.length>0&&"aftertitle"==opts.partsPos)&&(str+=""+t_feed_drawDateAndParts(opts,post,"aftertitle","col",recid)),opts.showShortDescr&&(str+=""+t_feed_drawDescr(opts,post,"small")),str+="  </div>",(opts.showDate&&"afterdescr"==opts.datePos||opts.showParts&&post.postparts.length>0&&"afterdescr"==opts.partsPos)&&(str+=""+t_feed_drawDateAndParts(opts,post,"afterdescr","col",recid)),opts.btnReadMore&&(str+=""+t_feed_drawReadMoreBtn(opts)),str+="</div>","afterdescr"==opts.imagePosPs&&(str+=""+t_feed_drawImage(opts,post,"afterdescr",recid,isBgModification)),str+="</div>"}function t_feed_drawSliderType(post,opts,gridColModification,recid){var isBgModification="bg"===gridColModification,btnsAlignClass=opts.btnsAlign?" t-feed__slider-grid__wrapper_align":"",paddingClass=isBgModification?" t-feed__slider-grid__content":"",paddingAfterDescr=isBgModification&&"afterdescr"==opts.imagePosPs?" t-feed__slider-grid__content_paddingtop":"",paddingSize=isBgModification?opts.colWithBg.paddingSize:"",marginBottom=isBgModification||"afterdescr"!=opts.imagePosPs?"":" t-feed__slider-grid__content_marginbottom";if(isBgModification||opts.blocksWidth)var styleStr=opts.blocksWidth?"width: "+opts.blocksWidth+"px;":"",style='style="'+(styleStr+=isBgModification?t_feed_addStyleToColWithBg(opts):"")+'"';var wrapperStyles,str="";return str+='<div class="t-feed__slds-wrapper t-slds__wrapper" '+('style="'+t_feed__getWrapperPaddingsWithShadowCard(opts)+'"')+">",str+='<div class="t-feed__slider-grid__post-wrapper t-col" '+style+">","beforetitle"!=opts.imagePosPs&&opts.imagePosPs||(str+=""+t_feed_drawImage(opts,post,"beforetitle",recid,isBgModification)),str+='<div class="t-feed__slider-grid__wrapper'+btnsAlignClass+paddingClass+paddingAfterDescr+marginBottom+" "+paddingSize+'">',(opts.showDate&&"beforetitle"==opts.datePos||opts.showParts&&post.postparts.length>0&&"beforetitle"==opts.partsPos)&&(str+=""+t_feed_drawDateAndParts(opts,post,"beforetitle","col",recid)),str+='  <div class="t-feed__textwrapper">',str+=""+t_feed_drawTitle(opts,post,"small",!1),(opts.showDate&&"aftertitle"==opts.datePos||opts.showParts&&post.postparts.length>0&&"aftertitle"==opts.partsPos)&&(str+=""+t_feed_drawDateAndParts(opts,post,"aftertitle","col",recid)),opts.showShortDescr&&(str+=""+t_feed_drawDescr(opts,post,"small")),str+="  </div>",(opts.showDate&&"afterdescr"==opts.datePos||opts.showParts&&post.postparts.length>0&&"afterdescr"==opts.partsPos)&&(str+=""+t_feed_drawDateAndParts(opts,post,"afterdescr","col",recid)),opts.btnReadMore&&(str+=""+t_feed_drawReadMoreBtn(opts)),str+="</div>","afterdescr"==opts.imagePosPs&&(str+=""+t_feed_drawImage(opts,post,"afterdescr",recid,isBgModification)),str+="</div>",str+="</div>"}function t_feed__getWrapperPaddingsWithShadowCard(opts){if(!(opts&&opts.colWithBg&&opts.colWithBg.shadowSize&&opts.colWithBg.shadowOpacity))return"";var paddingBottom=1*(1*opts.colWithBg.shadowSize.slice(0,-2)>1*opts.colWithBg.shadowSizeHover.slice(0,-2)?opts.colWithBg.shadowSize.slice(0,-2):opts.colWithBg.shadowSizeHover.slice(0,-2))+("md"===opts.colWithBg.shadowShiftyHover?20:"sm"===opts.colWithBg.shadowShiftyHover?10:0),styles="padding-top:"+opts.colWithBg.shadowSize+";";return styles+="padding-bottom:"+paddingBottom+"px;"}function t_feed_addStyleToColWithBg(opts){var style="",shadowSize,shadowOpacity;(style+=opts.colWithBg.background?"background-color:"+opts.colWithBg.background+";":"",style+=opts.colWithBg.borderRadius?"border-radius:"+opts.colWithBg.borderRadius+";":"",opts.colWithBg.shadowSize||opts.colWithBg.shadowOpacity)&&(style+="box-shadow: 0px 0px "+(opts.colWithBg.shadowSize?opts.colWithBg.shadowSize:"20px")+" 0px rgba(0, 0, 0, "+(opts.colWithBg.shadowOpacity?(parseInt(opts.colWithBg.shadowOpacity,10)/100).toFixed(2):"0.3")+");");return style}function t_feed_unifyColHeights(recid,opts){var rec=document.querySelector("#rec"+recid);if(rec){var feed=rec.querySelector(".js-feed"),posts=rec.querySelectorAll(".t-feed__post"),blocksPerRow=t_feed_getBlocksInRowHeight(opts,posts),gridType=feed.getAttribute("data-feed-grid-type"),container=rec.querySelector(".js-feed-container");if(!feed||"col"===gridType||"slider"===gridType)if(window.innerWidth<=480&&!opts.isHorizOnMob)Array.prototype.forEach.call(posts,(function(post){post.style.height="auto"}));else if(container.offsetWidth>0)if("slider"===gridType)t_feed_calcHeight(feed.querySelectorAll(".t-feed__slider-grid__wrapper")),t_onFuncLoad("t_slds_UpdateSliderHeight",(function(){t_slds_UpdateSliderHeight(recid)})),window.addEventListener("load",(function(){t_feed_calcHeight(feed.querySelectorAll(".t-feed__slider-grid__wrapper"))}));else for(var i=0;i<posts.length;i+=blocksPerRow){var postsArray,postsRows=Array.prototype.slice.call(posts).slice(i,i+blocksPerRow),cardsContent=[];postsRows.forEach((function(row){cardsContent.push(row.querySelector(".t-feed__col-grid__wrapper"))})),t_feed_calcHeight(cardsContent),window.addEventListener("load",(function(){t_feed_calcHeight(cardsContent)}))}}}function t_feed_calcHeight(cardsContent){var maxHeight=0;Array.prototype.forEach.call(cardsContent,(function(card){var cardComputedStyle=window.getComputedStyle(card);if(card&&cardComputedStyle&&"object"==typeof cardComputedStyle){var paddingTop=parseInt(cardComputedStyle["padding-top"],10),paddingBottom=parseInt(cardComputedStyle["padding-bottom"],10),datePartsHeightTop=0,datePartsHeightBottom=0,btnHeight=0,dateBeforeTitle=card.querySelector(".t-feed__post-parts-date-row_beforetitle");dateBeforeTitle&&null!=dateBeforeTitle.offsetHeight&&(datePartsHeightTop=t_feed_calcOuterHeight(dateBeforeTitle));var dateAfterDescr=card.querySelector(".t-feed__post-parts-date-row_afterdescr");dateAfterDescr&&null!=dateAfterDescr.offsetHeight&&(datePartsHeightBottom=t_feed_calcOuterHeight(dateAfterDescr));var btnReadMore=card.querySelector(".t-feed__button-readmore");btnReadMore&&null!=btnReadMore.offsetHeight&&(btnHeight=t_feed_calcOuterHeight(btnReadMore));var textWrapper=card.querySelector(".t-feed__textwrapper"),textHeight,height=datePartsHeightTop+datePartsHeightBottom+parseInt(getComputedStyle(textWrapper,null).height.replace("px",""),10)+paddingTop+paddingBottom+btnHeight;height>maxHeight&&(maxHeight=height)}})),Array.prototype.forEach.call(cardsContent,(function(card){card.style.height=maxHeight+"px"}))}function t_feed_calcOuterHeight(el){var height=el.offsetHeight,style=getComputedStyle(el);return height+=parseInt(style.marginTop)+parseInt(style.marginBottom)}function t_feed_getBlocksInRowHeight(opts,cols){return window.innerWidth<=960&&opts.isHorizOnMob?cols.length:window.innerWidth<=960?1:parseInt(opts.blocksInRow)}function t_feed_drawImageInRowBig(opts,post,position,recid){var imageUrl=post.thumb?post.thumb:post.image,height=opts.imageRatio+"%",str="",bgFieldAttr;""===post.thumb&&""===post.image&&"video"!==post.mediatype||!opts.showImage||(str+='<div class="t-feed__post-imgwrapper t-feed__post-imgwrapper_'+position+'" style="padding-bottom:'+height+';">',(opts.showDate&&"onimage"==opts.datePos||opts.showParts&&"onimage"==opts.partsPos)&&(str+=""+t_feed_drawDateAndParts(opts,post,"onimage","col",recid)),str+='<div class="t-feed__post-bgimg t-bgimg" '+(post.uid?'bgimgfield="fe_img__'+post.uid+'"':"")+' data-original="'+imageUrl+'" style="background-image:url('+t_feed_getLazyUrl(opts,imageUrl)+');"></div></div>');return str}function t_feed_drawImage(opts,post,position,recid,isBgModification){var imageRatio=opts.imageRatio?opts.imageRatio+"%":"66%",borderRadiusStyle=isBgModification&&opts.colWithBg.borderRadius?"border-radius:"+opts.colWithBg.borderRadius+" "+opts.colWithBg.borderRadius+" 0 0;":"",imageStyle='style="padding-bottom:'+imageRatio+";"+borderRadiusStyle+'"',mobileClass=opts.isHorizOnMob&&opts.hasOriginalAspectRatio?"t-feed__post-imgwrapper_mobile-nopadding":"",str="";if((""!==post.thumb||""!==post.image||"video"===post.mediatype)&&opts.showImage){var imageUrl=post.thumb?post.thumb:post.image;if("video"===post.mediatype&&-1!=post.mediadata.indexOf("vimeo")&&""===post.thumb&&(imageUrl="https://static.tildacdn.com/ffb6456b-781b-40e8-9517-ffb5225e8bcd/imgfish.jpg"),str+='<div class="t-feed__post-imgwrapper t-feed__post-imgwrapper_'+position+" "+mobileClass+'" '+imageStyle+">",(opts.showDate&&"onimage"==opts.datePos||opts.showParts&&"onimage"==opts.partsPos)&&(str+=""+t_feed_drawDateAndParts(opts,post,"onimage","col",recid)),opts.hasOriginalAspectRatio){var imgFieldAttr=post.uid?'imgfield="fe_img__'+post.uid+'"':"";str+="<img "+t_feed_getLazySrc(opts,imageUrl)+' class="t-feed__post-img t-img js-feed-img" '+imgFieldAttr+" />"}else{var bgFieldAttr;str+='<div class="t-feed__post-bgimg t-bgimg" '+(post.uid?'bgimgfield="fe_img__'+post.uid+'"':"")+' data-original="'+imageUrl+'" style="background-image:url('+t_feed_getLazyUrl(opts,imageUrl)+");"+borderRadiusStyle+'"></div>'}str+="</div>"}return str}function t_feed_drawTitle(opts,post,size,margin){var titleMargin=margin?"t-feed__post-title_margin":"",fontSize="t-name";"medium"==size&&(fontSize="t-heading");var typoSize="";4==opts.blocksInRow?typoSize+="t-name_xs":2!=opts.blocksInRow&&opts.blocksInRow?typoSize+="t-name_md":typoSize+="t-name_xl","medium"==size&&(typoSize="t-heading_lg");var str="",titleFieldAttr;return str+='<div class="js-feed-post-title t-feed__post-title '+titleMargin+" "+fontSize+" "+typoSize+'" '+(post.uid?'field="fe_title__'+post.uid+'" data-redactor-toolbar="no"':"")+' style="'+opts.typo.title+'">'+post.title+"</div>"}function t_feed_drawDescr(opts,post,size){var fontSize="xxs";"medium"==size&&(fontSize="sm");var str="",descrFieldAttr;""!=post.descr&&(str+='<div class="js-feed-post-descr t-feed__post-descr t-descr t-descr_'+fontSize+'" '+(post.uid?'field="fe_descr__'+post.uid+'" data-redactor-toolbar="no"':"")+' style="'+opts.typo.descr+'">'+t_feed_cropShortDescr(post,opts)+"</div>");return str}function t_feed_drawDateAndParts(opts,post,position,type,recid){var isOnImage="onimage"===position,isInRow="afterdescr"===position||"beforetitle"===position||"aftertitle"===position,datePosition="col"===type?opts.datePos:opts.datePosPs,partsPosition="col"===type?opts.partsPos:opts.partsPosPs,dateHTML='<span class="js-feed-post-date t-feed__post-date t-uptitle t-uptitle_xs" style="'+opts.typo.subtitle+'">'+t_feed_formateDate(post.date,opts,recid)+"</span>",labelWrapperHTML_open,labelWrapperHTML_close=isOnImage?"</div>":"",labelHTML_open=isOnImage?'<div class="t-feed__post-label">':"",labelHTML_close=isOnImage?"</div>":"",partsDateRowHTML_open,partsDateRowHTML_close=isInRow?"</div>":"",str="";return str+=isInRow?'<div class="t-feed__post-parts-date-row t-feed__post-parts-date-row_'+position+'">':"",str+=isOnImage?'<div class="t-feed__post-label-wrapper">':"",opts.showDate&&datePosition==position&&(str+=labelHTML_open,str+=dateHTML,str+=labelHTML_close),post.postparts.length>0&&opts.showParts&&partsPosition==position&&(str+=labelHTML_open,str+=""+t_feed_drawParts(opts,post),str+=labelHTML_close),str+=labelWrapperHTML_close,str+=partsDateRowHTML_close}function t_feed_drawParts(opts,post){var style=opts.typo.subtitle?'style="'+opts.typo.subtitle+'"':"",str="";return post.postparts.forEach((function(item){""!=item&&(str+='<span class="t-feed__post-tag t-uptitle t-uptitle_xs" '+style+">"+item.parttitle+"</span>")})),str}function t_feed_drawReadMoreBtn(opts){var btnTextColor=opts.btnTextColor?'style="color:'+opts.btnTextColor+';"':"",btnSize="sm"==opts.btnSize?"xs":"sm",btnWrapperClass,str="";return str+='<div class="t-feed__button-readmore '+("text"===opts.btnType?"t-feed__button-readmore_text":"")+'">',"text"===opts.btnType?str+='<div class="t-btntext" '+btnTextColor+">"+opts.btnReadMore+"</div>":str+='<div class="t-btn t-btn_'+btnSize+'" style="'+opts.btnStyle+'"><div class="t-feed__button-container"><span>'+opts.btnReadMore+"</span></div></div>",str+="</div>"}function t_feed_drawBtnsContainer(opts){var str="";return str+='<div class="t-feed__buttons-wrapper t-feed__buttons-wrapper_hidden t-container">',opts.btnText&&parseInt(opts.amountOfPosts,10)&&(str+=t_feed_drawShowMoreBtn(opts)),opts.btnAllPosts.text&&(str+=t_feed_drawShowAllPostsBtn(opts)),str+="</div>"}function t_feed_drawShowMoreBtn(opts){var str="";return opts.btnText&&(str+='<div class="t-feed__button-wrapper"><div class="js-feed-btn-show-more t-feed__showmore-btn t-btn t-btn_md" style="'+opts.bbtnStyle+'"><div class="t-feed__button-container"><span>'+opts.btnText+"</span></div></div></div>"),str}function t_feed_drawShowAllPostsBtn(opts){var target=opts.btnAllPosts.target?'target="_blank"':"",str="";return str+='<div class="t-feed__button-wrapper"><a href="'+opts.btnAllPosts.link+'" class="js-feed-btn-show-all-posts t-feed__showallpost-btn t-btn t-btn_md" '+target+' style="'+opts.bbtnStyle+'"><div class="t-feed__button-container"><span>'+opts.btnAllPosts.text+"</span></div></a></div>"}function t_feed_addFeedParts(recid,opts,feedPartsArr,feeduid){var rec,feed=document.querySelector("#rec"+recid).querySelector(".js-feed");opts.feedPartsArr=feedPartsArr;var tabsHtml=t_feed_drawFeedPartsControl(opts,feeduid,recid);feed.querySelector(".js-feed-parts-select-container").insertAdjacentHTML("afterbegin",tabsHtml),t_feed_initFeedParts(recid,opts)}function t_feed_drawFeedPartsControl(opts,feeduid,recid){var partsWithBg="";opts.parts_opts&&(partsWithBg=opts.parts_opts.partsBgColor||opts.parts_opts.partsBorderSize||opts.parts_opts.partsBorderColor?"t-feed__parts-switch-btn_bg":"");var alignClass="";opts.parts_opts&&(alignClass=opts.parts_opts.align&&"left"===opts.parts_opts.align?"t-align_left":"t-align_center");var str="",hideClass;str+='<div class="t-feed__parts-switch-wrapper '+alignClass+'">',str+='<div class="js-feed-parts-switcher t-feed__parts-switch-btn '+partsWithBg+" t-feed__parts-switch-btn-all t-name t-name_xs t-menu__link-item t-active"+(opts.showPartAll?"":" t-feed__parts-switch-btn_hide")+'" data-feedpart-title="" data-feedpart-uid="'+opts.feeduid+'"><span>'+t_feed_getDictionary("all",recid)+"</span></div>";for(var i=0;i<opts.feedPartsArr.length;i++){var feedPart=opts.feedPartsArr[i];str+='<div class="js-feed-parts-switcher t-feed__parts-switch-btn '+partsWithBg+' t-name t-name_xs t-menu__link-item" data-feedpart-title="'+feedPart.title+'" data-feedpart-uid="'+feedPart.uid+'"><a href="#!/tfeeds/'+feeduid+"/c/"+feedPart.title+'">'+feedPart.title+"</a></div>"}return str+="</div>"}function t_feed_getLazyUrl(opts,imgSrc){if(!opts.isPublishedPage||"y"!==window.lazy)return imgSrc;if(-1===imgSrc.indexOf("static.tildacdn.com"))return imgSrc;var arr=imgSrc.split("/"),newSrc;return arr.splice(imgSrc.split("/").length-1,0,"-/resizeb/x20"),arr.join("/")}function t_feed_getLazySrc(opts,imgSrc){if(!opts.isPublishedPage||"y"!==window.lazy)return'src="'+imgSrc+'"';var arr=imgSrc.split("/"),newSrc;return arr.splice(imgSrc.split("/").length-1,0,"-/empty"),'src="'+arr.join("/")+'" data-original="'+imgSrc+'"'}function t_feed_drawPostSeparatorLine(opts){var str="",style="";return style+=opts.separator.height?"height:"+opts.separator.height+";":"",style+=opts.separator.color?"background-color:"+opts.separator.color+";":"",str+='<div class="t-feed__post__line-separator" '+(style=(style+=opts.separator.opacity?"opacity:"+opts.separator.opacity/100+";":"")?'style="'+style+'"':"")+"></div>"}function t_feed_cropShortDescr(post,opts){var postDescr=post.descr;return""!=opts.amountOfSymbols&&(postDescr=(postDescr=(postDescr=postDescr.replace(/<[^>]+>/g,"")).replace(/&nbsp;/g," ")).substr(0,opts.amountOfSymbols),post.descr.length>opts.amountOfSymbols&&(postDescr+=" ...")),postDescr}function t_feed_initPopup(recid,obj,obj_posts,opts){var rec=document.querySelector("#rec"+recid),feed=rec.querySelector(".js-feed"),gridType=feed.getAttribute("data-feed-grid-type"),currentUrl=window.location.href,popupTriggers=rec.querySelectorAll('[href^="#postpopup"]');Array.prototype.forEach.call(popupTriggers,(function(trigger){var parent,uid=trigger.closest(".t-feed__post").getAttribute("data-post-uid"),post=obj_posts[recid][uid];void 0!==post&&trigger.setAttribute("href",post.url)})),Array.prototype.forEach.call(popupTriggers,(function(trigger){trigger.addEventListener("click",(function(e){e.preventDefault(),"side-panel"===gridType&&feed.classList.add("t946__feed-container_expanded");var postItem,lid_post=trigger.closest(".js-feed-post").getAttribute("data-post-uid"),post=obj_posts[recid][lid_post],ctrlKey=e.ctrlKey,cmdKey=e.metaKey&&-1!==navigator.platform.indexOf("Mac");ctrlKey||cmdKey?window.open(post.url):(obj.header||obj.footer)&&obj.disablepopup?location.href=post.url:t_feed_workPostPopup(recid,obj,post,lid_post,opts)}))})),document.addEventListener("keydown",(function(e){27===e.keyCode&&t_feed_closePopup(recid,opts,currentUrl)}))}function t_feed_workPostPopup(recid,obj,post,lid_post,opts){var rec,feed=document.querySelector("#rec"+recid).querySelector(".js-feed");if(void 0!==window.tFeedPosts[recid]&&(window.tFeedPosts[recid].title=document.title),opts.popup_opts.isShare){var script=document.createElement("script");script.src="https://static.tildacdn.com/js/ya-share.js",script.async=!0,document.body.appendChild(script)}feed.insertAdjacentHTML("beforeend",t_feed_drawWholePostPopup(obj,post,opts,lid_post,recid));var code=obj.code;""!=code&&null!=code&&-1!==code.indexOf("VK")&&1!=post.disablecomments&&t_feed_loadCommentsVkWidget(feed),"all"!==opts.popup_opts.showRelevants&&"cc"!==opts.popup_opts.showRelevants||t_feed_addRelevantsPosts(recid,opts,post,lid_post),setTimeout((function(){opts.popup_opts.zoom&&t_feed_addZoom()}),100),t_feed_showPopup(recid,post,opts),document.title=(post.title||"").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&nbsp;/g," "),void 0!==post.needGetPost&&(t_feed_addPostPopupLoader(),t_feed_loadPostPopupData(recid,lid_post,opts)),"gallery"==post.mediatype&&(""===opts.popup_opts.bgSize?setTimeout((function(){t_feed_addPostPopupGallery(recid,post)}),500):t_feed_addPostPopupGallery(recid,post)),opts.isPublishedPage&&t_feed_changeURL(obj,post)}function t_feed_loadCommentsVkWidget(feed){var scripts=feed.querySelector(".t-feed__post-popup__comments").querySelectorAll("script");Array.prototype.forEach.call(scripts,(function(oldScript){var newScript=document.createElement("script");if(Array.prototype.forEach.call(oldScript.attributes,(function(attr){newScript.setAttribute(attr.name,attr.value)})),0===oldScript.innerHTML.length){var script=document.createElement("script");script.src=oldScript.attributes.src.value,document.head.appendChild(script)}else newScript.appendChild(document.createTextNode(oldScript.innerHTML)),setTimeout((function(){oldScript.parentNode.replaceChild(newScript,oldScript)}),500)}))}function t_feed_loadPostPopupData(recid,lid_post,opts){var apiUrl="https://feeds.tildacdn.com/api/getpost/?postuid="+lid_post,records,projectid;opts.isPublishedPage||(apiUrl="https://tilda.cc/projects/feeds/getpost/?projectid="+document.querySelector(".t-records").getAttribute("data-tilda-project-id")+"&postuid="+lid_post);var ts=Date.now(),request=new XMLHttpRequest;request.open("GET",apiUrl+"&"+recid,!0),request.timeout=25e3,request.onload=function(){if(this.status>=200&&this.status<400){if(""===request.response)return;var obj;if("object"!=typeof JSON.parse(request.response))return;var text="";try{text=JSON.parse(request.response).post.text}catch(e){}document.querySelector(".js-feed-post-text").innerHTML=text,opts.popup_opts.zoom&&t_feed_addZoom(),t_feed_initCodeHightlight()}},request.onerror=function(){var xhr=request.response,ts_delta=Date.now()-ts;0==xhr.status&&ts_delta<100&&0!==xhr.readyState&&alert("Request error (get posts). Please check internet connection...")},request.send()}function t_feed_addPostPopupGallery(recid,post){""!==post.mediadata&&JSON.parse(post.mediadata).length>0&&(t_feed_setGalleryImageHeight(recid),t_feed_onFuncLoad("t_sldsInit",(function(){t_sldsInit(recid+" .t-feed__post-popup"),"y"!==window.lazy&&"yes"!==document.querySelector("#allrecords").getAttribute("data-tilda-lazy")||t_feed_onFuncLoad("t_lazyload_update",(function(){t_lazyload_update()})),t_feed_onFuncLoad("t_slds_updateSlider",(function(){t_slds_updateSlider(recid)})),t_feed_onFuncLoad("t_slds_UpdateSliderHeight",(function(){t_slds_UpdateSliderHeight(recid)})),t_feed_onFuncLoad("t_slds_UpdateSliderArrowsHeight",(function(){t_slds_UpdateSliderArrowsHeight(recid)}))})))}function t_feed_addPostPopupLoader(){for(var loader="",i=0;i<20;i++)loader+='<div class="t-feed__post-popup__text-loader"></div>';document.querySelector(".js-feed-post-text").innerHTML=loader}function t_feed_addZoom(){var images=document.querySelectorAll(".js-feed-post-text img");Array.prototype.forEach.call(images,(function(image){image.classList.add("t-zoomable"),image.setAttribute("data-zoomable","yes"),image.setAttribute("data-img-zoom-url",image.getAttribute("src"))}))}function t_feed_showPopup(recid,post,opts){var rec,popup=document.querySelector("#rec"+recid).querySelector(".t-feed__post-popup.t-popup"),arrowTop=popup.querySelector(".t-feed__post-popup__arrow-top"),currentUrl=window.location.href;popup.style.display="block",popup.classList.add("t-popup_show"),setTimeout((function(){popup.querySelector(".t-popup__container").classList.remove("t-feed__post-popup__container_loading")}),300),setTimeout((function(){popup.querySelector(".t-popup__container").classList.add("t-popup__container-animated"),"y"!==window.lazy&&"yes"!==document.querySelector("#allrecords").getAttribute("data-tilda-lazy")||t_feed_onFuncLoad("t_lazyload_update",(function(){t_lazyload_update()}))}),50),document.body.classList.add("t-body_popupshowed"),t_feed_getCountOfViews(popup),arrowTop&&(popup.addEventListener("scroll",(function(){t_feed_addPostPopupArrowTop(this,arrowTop)})),arrowTop.addEventListener("click",(function(){t_feed_scrollTo(popup,0,300)}))),t_feed_openShare(popup),t_feed_sendDataToAnalytics(popup,post),document.querySelector(".js-feed-popup-close").addEventListener("click",(function(){t_feed_closePopup(recid,opts,currentUrl)})),window.addEventListener("beforeprint",(function(){document.location.reload()}))}function t_feed_scrollTo(element,to,duration){if(!(duration<=0)){var difference,perTick=(to-element.scrollTop)/duration*10;setTimeout((function(){element.scrollTop=element.scrollTop+perTick,element.scrollTop!==to&&t_feed_scrollTo(element,to,duration-10)}),10)}}function t_feed_sendDataToAnalytics(popup,post){var urlWithoutDomenStart=post.url.indexOf("/tpost"),urlWithoutDomen=post.url.substr(urlWithoutDomenStart),analytics;popup.getAttribute("data-track-popup")>""&&Tilda.sendEventToStatistics(urlWithoutDomen)}function t_feed_openShare(popup){window.jQuery&&popup instanceof jQuery&&(popup=document);var shareOpen=popup.querySelector(".js-feed-share-open"),shareWrapper=popup.querySelector(".t-feed__share"),shareContainer=popup.querySelector(".t-feed__share-container");if(shareOpen){var timerId=setInterval((function(){popup.querySelector(".ya-share2").classList.contains("ya-share2_inited")&&(shareOpen.classList.add("t-feed__share-icon_active"),clearInterval(timerId))}),100),timeout;if(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent))shareOpen.addEventListener("click",(function(){shareWrapper.classList.contains("t-feed__share_open")?shareWrapper.classList.remove("t-feed__share_open"):shareWrapper.classList.add("t-feed__share_open")}));else shareContainer.addEventListener("mouseover",(function(){shareOpen.classList.contains("t-feed__share-icon_active")&&shareWrapper.classList.add("t-feed__share_open"),clearTimeout(timeout)})),shareContainer.addEventListener("mouseout",(function(){timeout=setTimeout((function(){shareWrapper.classList.remove("t-feed__share_open")}),750)}))}}function t_feed_addPostPopupArrowTop(popup,arrowTop){var isShow=arrowTop.classList.contains("t-feed__post-popup__arrow-top_show");popup.scrollTop>300?isShow||arrowTop.classList.add("t-feed__post-popup__arrow-top_show"):isShow&&arrowTop.classList.remove("t-feed__post-popup__arrow-top_show")}function t_feed_getCountOfViews(popup){window.jQuery&&popup instanceof jQuery&&(popup=document.querySelector(".t-feed__post-popup"));var apiUrl="https://feeds.tildacdn.com/api/setpostviewed/";setTimeout((function(){var request=new XMLHttpRequest;request.open("GET",apiUrl+"?postuid="+popup.getAttribute("data-feed-popup-postuid"),!0),request.timeout=25e3,request.onload=function(){},request.onerror=function(){console.log(request.response)},request.send()}),3e3)}function t_feed_closePopup(recid,opts,currentUrl){var rec,feed;if(feed=document.querySelector("#rec"+recid).querySelector(".js-feed")){var popup=document.querySelector(".t-feed__post-popup.t-popup"),gridType=feed.getAttribute("data-feed-grid-type");if(popup){"side-panel"===gridType&&feed.classList.remove("t946__feed-container_expanded"),document.body.classList.remove("t-body_popupshowed"),popup.classList.remove("t-popup_show");var indexToRemove=currentUrl.indexOf("/tpost/");if(/iPhone|iPad|iPod/i.test(navigator.userAgent)&&indexToRemove<0&&(indexToRemove=currentUrl.indexOf("/tpost/"))<0&&(indexToRemove=currentUrl.indexOf("%2Ftpost%2F")),window.tFeedPosts[recid].title&&(document.title=window.tFeedPosts[recid].title),shareScript&&opts.popup_opts.isShare){var shareScript=document.querySelector('script[src^="https://static.tildacdn.com/js/ya-share.js"]');null!==shareScript.parentNode&&shareScript.parentNode.removeChild(shareScript)}if(setTimeout((function(){popup.scrollTop=0,popup&&!popup.classList.contains("t-popup_show")&&null!==popup.parentNode&&popup.parentNode.removeChild(popup),null!==window.history.state&&window.history.pushState(null,null,currentUrl)}),300),-1!=currentUrl.indexOf("#!")){var popup,feed,offset=(feed=(popup=document.querySelector(".t-feed__post-popup")).closest(".js-feed")).getBoundingClientRect(),offsetTop;t_feed_scrollToFeed(feed,void 0!==offset?offset.top+window.pageYOffset:0)}}}}function t_feed_changeURL(obj,post){var curUrl=window.location.href,hostUrl,postPathname,url=window.location.protocol+"//"+window.location.hostname+"/"+post.url.split("/").slice(3).join("/"),newPageTitle=document.title+"-"+post.title;-1===curUrl.indexOf("/tpost/")&&-1===curUrl.indexOf("%2Ftpost%2F")&&void 0!==history.pushState&&window.history.pushState({postData:"open",obj:obj,post:post},newPageTitle,url)}function t_feed_drawWholePostPopup(obj,post,opts,lid_post,recid){var rec,feed,gridType=document.querySelector("#rec"+recid).querySelector(".js-feed").getAttribute("data-feed-grid-type"),statAttr=opts.popup_opts.popupStat?'data-track-popup="'+opts.popup_opts.popupStat+'"':"",popupStyle=opts.popup_opts.overlayBgColorRgba?'style="background-color:'+opts.popup_opts.overlayBgColorRgba+'"':"",popupStyleClose=opts.popup_opts.overlayBgColorRgba?'style="background-color:'+opts.popup_opts.overlayBgColorRgba.replace("1)","0.9)")+'"':"",inOneColumnHTML_open=opts.popup_opts.inTwoColumns?"":'<div class="t-feed__post-popup__content t-col t-col_8">',inOneColumnHTML_close=opts.popup_opts.inTwoColumns?"":"</div>",inTwoColumnsHTML_open=opts.popup_opts.inTwoColumns?'<div class="t-feed__post-popup__content t-feed__post-popup__content_half t-feed__post-popup__content-col t-col t-col_6">':"",inTwoColumnsHTML_close=opts.popup_opts.inTwoColumns?"</div>":"",str="",panelClass,containerClass;return str+='<div class="t-feed__post-popup'+("side-panel"===gridType?" t-feed__post-popup_panel ":" ")+'t-popup" data-feed-popup-feeduid="'+obj.feeduid+'" data-feed-popup-postuid="'+lid_post+'" '+statAttr+" "+popupStyle+'><div class="t-feed__post-popup__close-wrapper t-feed__post-popup__close-wrapper_loading" '+popupStyleClose+">"+t_feed_drawPostPopupCloseIcon(opts)+t_feed_drawPopupTitle(obj,opts)+t_feed_drawSharing(opts)+"</div>",str+='<div class="t-feed__post-popup__container'+("side-panel"===gridType?" t-feed__post-popup__container_panel ":" ")+'t-feed__post-popup__container_loading t-container t-popup__container t-popup__container-static t-popup__container-animated"><div class="t-feed__post-popup__content-wrapper">',str+=inOneColumnHTML_open,opts.popup_opts.inTwoColumns||("aftertitle"==opts.popup_opts.imagePos?(str+=""+t_feed_addPostPopupHeading(opts,post,recid),str+=""+t_feed_drawPostPopupCover(recid,"aftertitle",opts,post)):(str+=""+t_feed_drawPostPopupCover(recid,"beforetitle",opts,post),str+=""+t_feed_addPostPopupHeading(opts,post,recid))),opts.popup_opts.inTwoColumns&&(str+=inTwoColumnsHTML_open,str+=""+t_feed_drawPostPopupCover(recid,"beforetitle",opts,post),str+=inTwoColumnsHTML_close),str+=inTwoColumnsHTML_open,opts.popup_opts.inTwoColumns&&(str+=""+t_feed_addPostPopupHeading(opts,post,recid)),str+=""+t_feed_drawPostPopupText(opts,post),post.authorname&&(str+=""+t_feed_drawPostPopupAuthor(opts,post)),str+=""+t_feed_drawPostPopupDateAndParts("aftertext",opts,post,recid),str+=inTwoColumnsHTML_close,str+=inOneColumnHTML_close,str+="</div>",""!=obj.code&&null!=obj.code&&1!=post.disablecomments&&(str+='<div class="t-feed__post-popup__content-wrapper"><div class="t-feed__post-popup__content t-col t-col_8"><div class="js-feed-comments t-feed__post-popup__comments">'+obj.code+"</div></div></div>"),""!=opts.popup_opts.showRelevants&&(str+='<div class="js-feed-relevants t-feed__post-popup__relevants"></div>'),str+="</div>",void 0!==opts.arrowtop_opts&&opts.arrowtop_opts.isShow&&(str+=""+t_feed_drawPostPopupArrowTop(opts)),str+="</div>"}function t_feed_addPostPopupHeading(opts,post,recid){var str="";return str+=""+t_feed_drawPostPopupDateAndParts("beforetitle",opts,post,recid),str+=""+t_feed_drawPostPopupTitle(opts,post),str+=""+t_feed_drawPostPopupDateAndParts("aftertitle",opts,post,recid)}function t_feed_drawPostPopupDateAndParts(position,opts,post,recid){var tags="",style=opts.popup_opts.subtitleColor?'style="color:'+opts.popup_opts.subtitleColor+'"':"";post.postparts.forEach((function(item){tags+='<a href="'+item.parturl+'" class="t-feed__post-popup__tag"><span class="t-uptitle t-uptitle_xs" '+style+">"+item.parttitle+"</span></a>"}));var str="";return(opts.popup_opts.datePos==position&&""!=post.date||opts.popup_opts.partsPos==position&&post.postparts.length>0)&&(str+='<div class="t-feed__post-popup__date-parts-wrapper t-feed__post-popup__date-parts-wrapper_'+position+'">',opts.popup_opts.datePos==position&&(str+=""+t_feed_drawPostPopupDate(opts,post,recid)),opts.popup_opts.partsPos==position&&post.postparts.length>0&&(str+=tags),str+="</div>"),str}function t_feed_drawPostPopupCloseIcon(opts){var fillColor,str="";return str+='<div class="js-feed-popup-close t-popup__close"><div class="t-popup__close-wrapper"><svg class="t-popup__close-icon" width="11" height="20" viewBox="0 0 11 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M1 1L10 10L1 19" stroke="'+(opts.popup_opts.iconColor?opts.popup_opts.iconColor:"#000000")+'" stroke-width="2"/></svg></div></div>'}function t_feed_drawPopupTitle(obj,opts){var title=opts.popup_opts.closeText?opts.popup_opts.closeText:obj.feedtitle,titleStyle="",str;return opts.popup_opts.iconColor&&(titleStyle='style="color:'+opts.popup_opts.iconColor+'"'),'<div class="js-feed-popup-close t-feed__post-popup__close-text-wrapper"><div class="js-feed-popup-title t-feed__post-popup__close-text t-descr t-descr_xxs" '+titleStyle+">"+title+"</div></div>"}function t_feed_drawSharing(opts){var shareBg=opts.popup_opts.shareBg?'style="background-color:'+opts.popup_opts.shareBg+';"':'style="background-color: #ffffff;"',arrowColor=opts.popup_opts.shareBg?'style="border-bottom: 8px solid '+opts.popup_opts.shareBg+';"':"",fillColor=opts.popup_opts.iconColor?opts.popup_opts.iconColor:"rgba(0, 0, 0, 1)",str="";return void 0!==opts.popup_opts.isShare&&"false"!=opts.popup_opts.isShare&&opts.popup_opts.isShare&&(str+='<div class="t-feed__share-container"><div class="js-feed-share-open t-feed__share-icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 17.92 15.79" style="fill:'+fillColor+'"><g data-name="Слой 2"><path d="M16 9.67v6H.19v-12h7.18a7.1 7.1 0 00-1.46.89 7 7 0 00-1.08 1.11H2.19v8H14v-1.9z"/><path d="M17.73 5.7L12.16.13V3.8c-1.45.06-7 .73-7.62 7.08a.07.07 0 00.13 0c.49-1.35 2.11-3.43 7.49-3.52v3.88z"/></g></svg></div><div class="t-feed__share '+opts.popup_opts.shareStyle+'" '+shareBg+'><div class="t-feed__share-arrow" '+arrowColor+'></div><div class="ya-share2" data-access-token:facebook="'+opts.popup_opts.shareFBToken+'" data-yashareL10n="en" data-services="'+opts.popup_opts.shareServices+'" data-counter=""></div></div></div>'),str}function t_feed_drawPostPopupCover(recid,position,opts,post){var zoomClass=opts.popup_opts.zoom?" t-zoomable":"",zoomTarget=opts.popup_opts.zoom?' data-zoomable="yes" data-img-zoom-url="'+post.mediadata+'"':"",str="";return"image"==post.mediatype&&post.mediadata&&(str+='<div id="feed-cover" class="t-feed__post-popup__cover-wrapper t-feed__post-popup__cover-wrapper_'+position+'"><img src="'+post.mediadata+'" class="js-feed-post-image t-feed__post-popup__img t-img'+zoomClass+'"'+zoomTarget+"></div>"),"video"==post.mediatype&&post.mediadata&&(str+='<div class="t-feed__post-popup__cover-wrapper_video t-feed__post-popup__cover-wrapper t-feed__post-popup__cover-wrapper_'+position+'">'+t_feed_drawPostPopupVideo(post)+"</div>"),"gallery"==post.mediatype&&""!=post.mediadata&&JSON.parse(post.mediadata).length>0&&(str+='<div class="t-feed__post-popup__cover-wrapper t-feed__post-popup__cover-wrapper_'+position+'">'+t_feed_drawPostPopupGallery(recid,opts,post)+"</div>"),str}function t_feed_drawPostPopupVideo(post){var playerType="",videoId="",value=post.mediadata;-1!==value.indexOf("youtube")||-1!=value.indexOf("youtu.be")?playerType="youtube":-1!==value.indexOf("vimeo")?playerType="vimeo":-1!==value.indexOf(".mp4")&&(playerType="html5");var str="";return"youtube"===playerType&&((videoId=-1!=value.indexOf("youtube")?value.match(/youtube\.com\/watch\?v=([a-z0-9_-]{11})/i):value.match(/youtu\.be\/([a-z0-9_-]{11})/i))&&videoId.length>1&&(videoId=videoId[1]),str+='<iframe src="//youtube.com/embed/'+videoId+'?rel=0&fmt=18&html5=1&showinfo=0" width="100%" height="100%" frameborder="0" allowfullscreen></iframe>'),"vimeo"===playerType&&((videoId=value.match(/vimeo\.com\/([0-9]+)/i))&&videoId.length>1&&(videoId=videoId[1]),str+='<iframe src="//player.vimeo.com/video/'+videoId+'?title=0&byline=0&portrait=0&badge=0&color=ffffff" width="100%" height="100%" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>'),"html5"===playerType&&(str+='<video width="100%" height="100%" controls="controls"><source src="'+value+'" type="video/mp4">Your browser does not support the video tag.</video>'),str}function t_feed_drawPostPopupGallery(recid,opts,post){var galleryItems=JSON.parse(post.mediadata),galleryControl=void 0!==opts.gallery?opts.gallery.control:"",withArrowsClass,str="";return str+='<div class="t-slds" style="visibility: hidden;"><div class="t-container t-slds__main"><div class="t-slds__container t-width t-margin_auto"><div class="t-slds__items-wrapper '+("dots"!==galleryControl?" t-slds__witharrows":"")+'" data-slider-transition="" data-slider-with-cycle="true" data-slider-correct-height="true" data-auto-correct-mobile-width="false">',galleryItems.forEach((function(item,i){var activeClass=0==i?" t-slds__item_active":"",zoomClass=opts.popup_opts.zoom?" t-zoomable":"",zoomTarget=opts.popup_opts.zoom?' data-zoomable="yes" data-img-zoom-url="'+item.img+'"':"";if(str+='<div class="t-slds__item'+activeClass+'" data-slide-index="'+(i+1)+'"><div class="t-width t-margin_auto"><div class="t-slds__wrapper t-align_center">',void 0===opts.popup_opts.bgSize)str+='<div class="t_feed__post-popup__gallery-imgwrapper"><div class="t-slds__bgimg t-bgimg'+zoomClass+'"'+zoomTarget+' data-original="'+item.img+'" style="background-image: url('+t_feed_getLazyUrl(opts,item.img)+');"></div><div class="t-feed__post-popup__slider-separator" data-slider-image-width="860" data-slider-image-height="560"></div></div>';else{if("cover"==opts.popup_opts.bgSize||"contain"==opts.popup_opts.bgSize){var containBgSize="contain"==opts.popup_opts.bgSize?" t-slds__bgimg-contain":"";str+='<div class="t_feed__post-popup__gallery-imgwrapper"><div class="t-slds__bgimg'+containBgSize+" t-bgimg"+zoomClass+'"'+zoomTarget+' data-original="'+item.img+'" style="background-image: url('+t_feed_getLazyUrl(opts,item.img)+');"></div><div class="t-feed__post-popup__slider-separator" data-slider-image-width="860" data-slider-image-height="560"></div></div>'}var attrOnload;if(""==opts.popup_opts.bgSize)str+="<img "+(1==i?'onload="t_sldsInit('+recid+')" ':"")+t_feed_getLazySrc(opts,item.img)+' class="t-slds__img t-img'+zoomClass+'"'+zoomTarget+">"}str+="</div></div></div>"})),str+="</div>","dots"!==galleryControl&&(str+='<div class="t-slds__arrow_container">',1!=galleryItems.length&&(str+=""+t_feed_drawSliderArrow(opts,"left"),str+=""+t_feed_drawSliderArrow(opts,"right")),str+="</div>"),"dots"!==galleryControl&&""!==galleryControl||(str+=""+t_feed_drawSliderDots(galleryItems,opts)),str+="</div></div></div>"}function t_feed_drawSliderArrow(opts,direction){var arrowWidth="",arrowBgWidth="",isGallery=void 0!==opts.gallery,arrowColor="";isGallery&&(arrowColor=opts.gallery.arrowColor?opts.gallery.arrowColor:"#222222");var arrowBg=isGallery?opts.gallery.arrowBg:"",arrowBgHover=isGallery?opts.gallery.arrowBgHover:"",showBorder=isGallery?opts.gallery.showBorder:"",arrowSize=isGallery?opts.gallery.arrowSize:"",arrowBorderSize=isGallery?opts.gallery.arrowBorderSize:"";arrowBorderSize=""!==arrowBorderSize?parseInt(opts.gallery.arrowBorderSize):1;var str="";if(""!==arrowBg||""!==arrowBgHover||""!==showBorder)switch(arrowSize){case"sm":arrowWidth=6,arrowBgWidth=30;break;case"lg":arrowWidth=10,arrowBgWidth=50;break;case"xl":arrowWidth=14,arrowBgWidth=60;break;default:arrowWidth=8,arrowBgWidth=40}else switch(arrowSize){case"sm":arrowWidth=12;break;case"lg":arrowWidth=20;break;case"xl":arrowWidth=24;break;default:arrowWidth=16}var arrowWithBgClass,arrowStyle="";return""===arrowBg&&""===arrowBgHover&&""===showBorder||(arrowStyle+='style="',arrowStyle+="width:"+arrowBgWidth+"px;",arrowStyle+="height:"+arrowBgWidth+"px;",""!==showBorder&&(arrowStyle+="border: "+arrowBorderSize+"px solid "+arrowColor+";"),arrowStyle+='"'),str+='<div class="t-slds__arrow_wrapper t-slds__arrow_wrapper-'+direction+'" data-slide-direction="'+direction+'"><div class="t-slds__arrow t-slds__arrow-'+direction+" "+(""!==arrowBg||""!==arrowBgHover||""!==showBorder?" t-slds__arrow-withbg":"")+'" '+arrowStyle+'><div class="t-slds__arrow_body t-slds__arrow_body-'+direction+'" style="width: '+(arrowWidth+arrowBorderSize)+'px;"><svg style="display: block" viewBox="0 0 '+(arrowWidth+1.3*arrowBorderSize)+" "+(2*arrowWidth+arrowBorderSize)+'" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><polyline fill="none" stroke="'+arrowColor+'" stroke-linejoin="butt" stroke-linecap="butt" stroke-width="'+arrowBorderSize+'" points="'+arrowBorderSize/2+","+arrowBorderSize/2+" "+(arrowWidth+arrowBorderSize/2)+","+(arrowWidth+arrowBorderSize/2)+" "+arrowBorderSize/2+","+(2*arrowWidth+arrowBorderSize/2)+'" /></svg></div></div></div>'}function t_feed_drawSliderDots(galleryItems,opts){var isGallery=void 0!==opts.gallery,bulletWidth=isGallery?opts.gallery.dotsWidth:"8px";(bulletWidth=parseInt(bulletWidth))>20&&(bulletWidth=20);var activeBulletClass="",dotsActiveBg=isGallery?opts.gallery.dotsActiveBg:"";dotsActiveBg=""!==dotsActiveBg?dotsActiveBg:"#222222";var dotsBg=isGallery?opts.gallery.dotsBg:"",dotsBorderSize=isGallery?opts.gallery.dotsBorderSize:"",dotsStyle="";dotsStyle+=""!==bulletWidth?"width:"+bulletWidth+"px;height:"+bulletWidth+"px;":"",dotsStyle+=""!==dotsBg?"background-color:"+dotsBg+";":"",dotsStyle+=""!==dotsBorderSize?"border:"+dotsBorderSize+" solid "+dotsActiveBg+";":"";var str="";return str+='<div class="t-slds__bullet_wrapper">',galleryItems.forEach((function(item,i){1!=item.length&&(str+='<div class="t-slds__bullet'+(activeBulletClass=0==i?" t-slds__bullet_active":"")+'" data-slide-bullet-for="'+(i+1)+'"><div class="t-slds__bullet_body" style="'+dotsStyle+'"></div></div>')})),str+="</div>"}function t_feed_setGalleryImageHeight(recid){var rec,images=document.querySelector("#rec"+recid).querySelectorAll(".t-feed__post-popup__slider-separator");Array.prototype.forEach.call(images,(function(image){var width=image.getAttribute("data-slider-image-width"),height,ratio,padding=100*(image.getAttribute("data-slider-image-height")/width);image.style.paddingBottom=padding+"%"}))}function t_feed_initCodeHightlight(){var post=document.querySelector(".js-feed-post-text");if(post){var codeBlocks=post.querySelectorAll(".t-redactor__highlightcode code");codeBlocks.length&&(void 0!==window.hljs?t_feed_highlightCodeBlocks(codeBlocks):t_feed_loadCodeHighlight((function(){t_feed_highlightCodeBlocks(codeBlocks)})))}}function t_feed_loadCodeHighlight(callback){var script=document.createElement("script"),style=document.createElement("link");style.href="https://static.tildacdn.com/css/highlight.min.css",script.src="https://static.tildacdn.com/js/highlight.min.js",style.type="text/css",style.rel="stylesheet",callback&&(script.onload=callback),document.head.appendChild(script),document.head.appendChild(style)}function t_feed_highlightCodeBlocks(codeBlocks){Array.prototype.forEach.call(codeBlocks,(function(codeBlock){window.hljs.highlightBlock(codeBlock)}))}function t_feed_PostInit(){t_feed_initCodeHightlight()}function t_feed_drawPostPopupDate(opts,post,recid){var style=opts.popup_opts.subtitleColor?'style="color:'+opts.popup_opts.subtitleColor+'"':"",str="";return(void 0===opts.popup_opts.showDate||opts.popup_opts.showDate)&&(str+='<span class="t-feed__post-popup__date-wrapper"><span class="js-feed-post-date t-feed__post-popup__date t-uptitle t-uptitle_sm" '+style+">"+t_feed_formateDate(post.date,opts,recid)+"</span></span>"),str}function t_feed_drawPostPopupTitle(opts,post){var style=opts.popup_opts.titleColor?'style="color:'+opts.popup_opts.titleColor+'"':"",str="";return post.title&&(str+='<div class="t-feed__post-popup__title-wrapper"><div class="js-feed-post-title t-feed__post-popup__title t-title t-title_xxs" '+style+">"+post.title+"</div></div>"),str}function t_feed_drawPostPopupText(opts,post){var style=opts.popup_opts.textColor?'style="color:'+opts.popup_opts.textColor+'"':"",text="";post.text?text=post.text:post.descr&&void 0===post.needGetPost&&(text=post.descr);var textFF="",str="";return(text||post.needGetPost)&&(str+='<div id="feed-text" class="t-feed__post-popup__text-wrapper" data-animationappear="off"><div class="js-feed-post-text t-feed__post-popup__text t-text t-text_md" '+style+">"+text+"</div></div>"),str}function t_feed_drawPostPopupAuthor(opts,post){var authorLink_open=post.authorurl?'<a href="'+post.authorurl+'" class="t-feed__post-popup__author-link" target="_blank">':"",authorLink_close=post.authorurl?"</a>":"",style=opts.popup_opts.textColor?'style="color:'+opts.popup_opts.textColor+'"':"",str="";return str+=authorLink_open,str+='<div class="js-feed-post-author t-feed__post-popup__author-wrapper">',post.authorimg&&(str+='<div class="js-feed-post-author-image t-feed__post-popup__author-bgimg t-bgimg" data-original="'+post.authorimg+'" style="background-image:url('+post.authorimg+')"></div>'),post.authorname&&(str+='<span class="js-feed-post-author-name t-feed__post-popup__author-name t-descr t-descr_xxs" '+style+">"+post.authorname+"</span>"),str+="</div>",str+=authorLink_close}function t_feed_addRelevantsPosts(recid,opts,obj,postuid){var ts=Date.now(),request=new XMLHttpRequest;request.open("GET",t_feed_createRelevantsURL(opts,obj,postuid),!0),request.timeout=25e3,request.onload=function(){if(this.status>=200&&this.status<400){if(""===request.response)return;var obj=JSON.parse(request.response);if("object"!=typeof obj)return;t_feed_addRelevantsHTML(recid,opts,obj)}},request.onerror=function(){var ts_delta=Date.now()-ts;0==request.response.status&&ts_delta<100&&0!==request.response.readyState&&alert("Request error (get posts). Please check internet connection...")},request.send()}function t_feed_createRelevantsURL(opts,obj,postuid){var method="random",postsFromPart="",apiUrl;switch(opts.popup_opts.methodRelevants){case"random":method="random";break;case"newest":method="last";break;case"pop":method="popular";break;case"unpop":method="unpopular"}return"cc"==opts.popup_opts.showRelevants&&void 0!==obj.postparts[0]&&(postsFromPart="&partuid="+obj.postparts[0].partuid),"https://feeds.tildacdn.com/api/getrelevantposts/?postuid="+postuid+"&size=4&method="+method+postsFromPart}function t_feed_addRelevantsHTML(recid,opts,obj){var relevantsHTML="",relevantsPosts=obj.relevants,relevantsWrapper;if(relevantsPosts.length>0){relevantsHTML+=""+t_feed_addRelevantsTitle(recid,opts),relevantsHTML+='<div class="t-feed__post-popup__relevants-wrapper">';for(var i=0;i<relevantsPosts.length;i++){var post=relevantsPosts[i];"cols"==opts.popup_opts.styleRelevants?relevantsHTML+=""+t_feed_drawRelevantsPostInCol(opts,post):relevantsHTML+=""+t_feed_drawRelevantsPostInRow(opts,post)}relevantsHTML+="</div>"}document.querySelector(".js-feed-relevants").insertAdjacentHTML("beforeend",relevantsHTML)}function t_feed_addRelevantsTitle(recid,opts){var style=opts.popup_opts.titleColor?' style="color:'+opts.popup_opts.titleColor+'";':"",widthWrapper,title,str;return'<div class="t-feed__post-popup__relevants-title-wrapper t-col'+("cols"==opts.popup_opts.styleRelevants?" t-col_12":" t-col_8 t-prefix t-prefix_2")+'"><div class="t-feed__post-popup__relevants-title t-align_left t-uptitle t-uptitle_xxl"'+style+">"+(opts.popup_opts.titleRelevants?opts.popup_opts.titleRelevants:t_feed_getDictionary("seealso",recid))+"</div></div>"}function t_feed_drawRelevantsPostInRow(opts,post){var str;return'<div class="t-feed__post-popup__relevants-item-wrapper"><div class="t-feed__post-popup__relevants-item t-feed__post-popup__relevants-item_row t-col t-col_8 t-prefix t-prefix_2 t-align_left"><a class="" href="'+post.url+'"><div class="t-feed__post-popup__relevants-content">'+t_feed_drawRelevantsPostContent(opts,post)+"</div></a></div></div>"}function t_feed_drawRelevantsPostInCol(opts,post){var str;return'<div class="t-feed__post-popup__relevants-item t-col t-col_3 t-align_left"><a class="" href="'+post.url+'">'+t_feed_drawRelevantsPostContent(opts,post)+"</a></div>"}function t_feed_drawRelevantsPostContent(opts,post){var imageRatio,imageStyle;if("cols"==opts.popup_opts.styleRelevants)imageStyle='style="padding-bottom:'+(imageRatio=opts.imageRatio?opts.imageRatio+"%":"66%")+';"';else{imageRatio=opts.imageRatio?opts.imageRatio/100:"0.75";var width="100px";window.innerWidth<=560&&(width="60px"),imageStyle='style="height: calc('+width+" * "+imageRatio+');"'}var titleStyle=opts.popup_opts.titleColor?' style="color:'+opts.popup_opts.titleColor+'";':"",textStyle=opts.popup_opts.textColor?' style="color:'+opts.popup_opts.textColor+'";':"",partsStyle=opts.popup_opts.subtitleColor?' style="color:'+opts.popup_opts.subtitleColor+'";':"",imgSrc="";post.thumb?imgSrc=post.thumb:post.image&&(imgSrc=post.image);var str="";return imgSrc&&(str+='<div class="t-feed__post-popup__relevants-imgwrapper" '+imageStyle+'><div class="t-feed__post-popup__relevants-bgimg t-bgimg" data-original="'+imgSrc+'" style="background-image: url('+imgSrc+');"></div></div>'),str+='<div class="t-feed__post-popup__relevants-textwrapper"><div class="t-feed__post-popup__relevants-parts" style="">',post.postparts.forEach((function(item){""!=item&&(str+='<span class="t-feed__post-popup__relevants-item-tag t-uptitle t-uptitle_xs"'+partsStyle+">"+item.parttitle+"</span>")})),str+="</div>",post.title&&(str+='<div class="t-feed__post-popup__relevants-item-title t-name t-name_xs"'+titleStyle+">"+post.title+"</div>"),post.descr&&(str+='<div class="t-feed__post-popup__relevants-item-descr t-descr t-descr_xxs"'+textStyle+">"+post.descr+"</div>"),str+="</div>"}function t_feed_drawPostPopupArrowTop(opts){var color=opts.arrowtop_opts.color?'style="fill: '+opts.arrowtop_opts.color+';"':"",bottomCoordinate=opts.arrowtop_opts.bottom?opts.arrowtop_opts.bottom:"20px",position="left:20px;";opts.arrowtop_opts.left&&(position="left:"+opts.arrowtop_opts.left+";"),opts.arrowtop_opts.right&&(position="right:"+opts.arrowtop_opts.right+";");var style,str="";switch(str+='<div class="t-feed__post-popup__arrow-top" '+('style="position:fixed;z-index:1;bottom:'+bottomCoordinate+";"+position+'min-height:30px;"')+">",+opts.arrowtop_opts.style){case 2:str+='<svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" viewBox="0 0 48 48"><path '+color+' d="M24 3.125c11.511 0 20.875 9.364 20.875 20.875S35.511 44.875 24 44.875 3.125 35.511 3.125 24 12.489 3.125 24 3.125m0-3C10.814.125.125 10.814.125 24S10.814 47.875 24 47.875 47.875 37.186 47.875 24 37.186.125 24 .125z"/><path '+color+' d="M25.5 36.033a1.5 1.5 0 11-3 0V16.87l-7.028 7.061a1.497 1.497 0 01-2.121.005 1.5 1.5 0 01-.005-2.121l9.591-9.637A1.498 1.498 0 0124 11.736h.001c.399 0 .783.16 1.063.443l9.562 9.637a1.5 1.5 0 01-2.129 2.114l-6.994-7.049-.003 19.152z"/></svg>';break;case 3:str+='<svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" viewBox="0 0 48 48"><path '+color+' d="M43.006 47.529H4.964a4.805 4.805 0 01-4.791-4.791V4.697A4.805 4.805 0 014.964-.094h38.042a4.805 4.805 0 014.791 4.791v38.042a4.805 4.805 0 01-4.791 4.79zM25.503 16.881l6.994 7.049a1.5 1.5 0 102.129-2.114l-9.562-9.637a1.5 1.5 0 00-1.063-.443H24c-.399 0-.782.159-1.063.442l-9.591 9.637a1.5 1.5 0 102.126 2.116L22.5 16.87v19.163a1.5 1.5 0 103 0l.003-19.152z"/></svg>';break;case 1:default:str+='<svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" viewBox="0 0 48 48"><path '+color+' d="M47.875 24c0 13.186-10.689 23.875-23.875 23.875S.125 37.186.125 24 10.814.125 24 .125 47.875 10.814 47.875 24zm-22.372-7.119l6.994 7.049a1.5 1.5 0 102.129-2.114l-9.562-9.637a1.5 1.5 0 00-1.063-.443H24c-.399 0-.782.159-1.063.442l-9.591 9.637a1.5 1.5 0 102.126 2.116L22.5 16.87v19.163a1.5 1.5 0 103 0l.003-19.152z"/></svg>'}return str+="</div>"}function t_feed_drawEmptyMessage(opts,recid){var styles,str;return'<div class="js-feed-error-msg t-feed__error-msg-cont t-col t-col_12"><div class="t-feed__error-msg-wrapper t-descr t-descr_sm" style="'+(opts.typo.titleColor?"color:"+opts.typo.titleColor+";border-color:"+opts.typo.titleColor+";":"")+'"><div class="t-feed__error-msg">'+t_feed_getDictionary("emptypartmsg",recid)+"</div></div></div>"}function t_feed_drawErrorBox(opts,errorText){var styles,str;return'<div class="js-feed-error-msg t-feed__error-msg-cont t-col t-col_12"><div class="t-feed__error-msg-wrapper t-descr t-descr_sm" style="'+(opts.typo.titleColor?"color:"+opts.typo.titleColor+";border-color:"+opts.typo.titleColor+";":"")+'"><div class="t-feed__error-msg">'+errorText+"</div></div></div>"}function t_feed_formateDate(date,opts,recid){var dayDate=date.split(" ")[0],timeDate=date.split(" ")[1],dateParts=dayDate.split("-"),newDate=new Date(dateParts[0],dateParts[1]-1,dateParts[2]),time=1==+opts.timeFormat?" "+timeDate:"",newMonth=newDate.getMonth(),day=dateParts[2],month=dateParts[1],year=dateParts[0],monthArr,monthTitle=t_feed_getDictionary(["january","february","march","april","may","june","july","august","september","october","november","december"][newMonth],recid);switch(+opts.dateFormat){case 1:return month+"-"+day+"-"+year+time;case 2:return day+"-"+month+"-"+year+time;case 3:return day+"/"+month+"/"+year+time;case 4:return day+"."+month+"."+year+time;case 5:return monthTitle[0]+" "+day+", "+year+time;case 6:return day+" "+monthTitle[1]+" "+year+time;default:return t_feed_addDefaultDate(recid,dateParts,date,monthTitle,time)}}function t_feed_addDefaultDate(recid,dateParts,date,monthTitle,time){var lang=t_feed_returnLang(recid),currentDate=new Date,postDateMs,diffDate=currentDate-Date.parse(date),days=Math.floor(diffDate/864e5),agoTitle=t_feed_getDictionary("ago",recid),daysTitle=("RU"==lang||"UK"==lang)&&days>4?t_feed_getDictionary("days",recid)[1]:t_feed_getDictionary("days",recid)[0],currentYear=currentDate.getFullYear(),postYear=+date.split("-")[0],agoTitleSeparator="JA"==lang||"ZH"==lang?"":" ",year=postYear!=currentYear?postYear:"",defaultDate="";return 0==days&&(defaultDate=t_feed_getDictionary("today",recid)),1==days&&(defaultDate=t_feed_getDictionary("yesterday",recid)),days>1&&days<15&&(defaultDate="FR"==lang||"DE"==lang||"ES"==lang||"PT"==lang?agoTitle+agoTitleSeparator+days+agoTitleSeparator+daysTitle:days+agoTitleSeparator+daysTitle+agoTitleSeparator+agoTitle),(days>=15||postYear>currentYear)&&(defaultDate=t_feed_addFullDate(lang,dateParts[2],monthTitle,year)+time),defaultDate}function t_feed_addFullDate(lang,day,month,year){var monthSeparator="DE"==lang?". ":" ",datePartSeparator=" ";"EN"==lang?datePartSeparator=""!=year?", ":"":"ES"!=lang&&"PT"!=lang||(datePartSeparator=""!=year?" de ":"");var monthTitle=month[1];return"EN"!=lang&&"DE"!=lang||(monthTitle=month[0]),"EN"==lang?monthTitle+" "+day+datePartSeparator+year:"JA"==lang||"ZH"==lang?year+monthTitle+day:day+monthSeparator+monthTitle+datePartSeparator+year}function t_feed_getDictionary(msg,recid){var dict=[];dict.emptypartmsg={EN:"Nothing found",RU:"Ничего не найдено",FR:"Rien trouvé",DE:"Nichts gefunden",ES:"Nada encontrado",PT:"Nada encontrado",UK:"Нічого не знайдено",JA:"何も見つかりませんでした",ZH:"什么都没找到",PL:"Nic nie znaleziono",KK:"Ештеңе табылмады",IT:"Non abbiamo trovato nulla",LV:"Nekas nav atrasts"},dict.all={EN:"All",RU:"Все",FR:"Tout",DE:"Alles",ES:"Todos",PT:"Todos",UK:"Всі",JA:"すべて",ZH:"所有",PL:"Wszystko",KK:"Барлық",IT:"Tutte",LV:"Visi"},dict.seealso={EN:"See also",RU:"Смотрите также",FR:"Voir également",DE:"Siehe auch",ES:"Ver también",PT:"Veja também",UK:"Дивись також",JA:"また見なさい",ZH:"也可以看看",PL:"Patrz również",KK:"Сондай-ақ, қараңыз",IT:"Guarda anche",LV:"Skatīt arī"},dict.today={EN:"Today",RU:"Сегодня",FR:"Aujourd'hui",DE:"Heute",ES:"Hoy",PT:"Hoje",UK:"Сьогодні",JA:"今日",ZH:"今天",PL:"Dzisiaj",KK:"Бүгін",IT:"Oggi",LV:"Šodien"},dict.yesterday={EN:"Yesterday",RU:"Вчера",FR:"Hier",DE:"Gestern",ES:"Ayer",PT:"Ontem",UK:"Вчора",JA:"昨日",ZH:"昨天",PL:"Wczoraj",KK:"Кеше",IT:"Ieri",LV:"Vakar"},dict.days={EN:["days"],RU:["дня","дней"],FR:["jours"],DE:["tagen"],ES:["dias"],PT:["dias"],UK:["дні","днів"],JA:["日"],ZH:["天"],PL:["dni"],KK:["күн"],IT:["giorni"],LV:["dienas"]},dict.ago={EN:"ago",RU:"назад",FR:"Il y a",DE:"Vor",ES:"Hace",PT:"Há",UK:"тому",JA:"前",ZH:"前",PL:"powrót",KK:"бұрын",IT:"fa",LV:"pirms"},dict.january={EN:["January","january"],RU:["Январь","января"],FR:["Janvier","janvier"],DE:["Januar","januar"],ES:["Enero","de enero"],PT:["Janeiro","de janeiro"],UK:["Січень","січня"],JA:["一月","一月"],ZH:["一月","一月"],PL:["Styczeń","styczenia"],KK:["Қаңтар"],IT:["Gennaio"],LV:["Janvāris"]},dict.february={EN:["February","february"],RU:["Февраль","февраля"],FR:["Février","février"],DE:["Februar","februar"],ES:["Febrero","de febrero"],PT:["Fevereiro","de fevereiro"],UK:["Лютий","лютого"],JA:["二月","二月"],ZH:["二月","二月"],PL:["Luty","lutego"],KK:["Ақпан"],IT:["Febbraio"],LV:["Februāris"]},dict.march={EN:["March","March"],RU:["Март","марта"],FR:["Mars","mars"],DE:["März","märz"],ES:["Marzo","de marzo"],PT:["Março","de março"],UK:["Березень","березня"],JA:["三月","三月"],ZH:["三月","三月"],PL:["Marzec","marca"],KK:["Наурыз"],IT:["Marzo"],LV:["Marts"]},dict.april={EN:["April","april"],RU:["Апрель","апреля"],FR:["Avril","avril"],DE:["April","april"],ES:["Abril","de abril"],PT:["Abril","de abril"],UK:["Квітень","квітня"],JA:["四月","四月"],ZH:["四月","四月"],PL:["Kwiecień","kwietnia"],KK:["Сәуір"],IT:["Aprile"],LV:["Aprīlis"]},dict.may={EN:["May","may"],RU:["Май","мая"],FR:["Mai","mai"],DE:["Kann","kann"],ES:["Mayo","de mayo"],PT:["Maio","de maio"],UK:["Травень","травня"],JA:["五月","五月"],ZH:["五月","五月"],PL:["Maj","maja"],KK:["Мамыр"],IT:["Maggio"],LV:["Maijs"]},dict.june={EN:["June","june"],RU:["Июнь","июня"],FR:["Juin","juin"],DE:["Juni","juni"],ES:["Junio","de junio"],PT:["Junho","de junho"],UK:["Червень","червня"],JA:["六月","六月"],ZH:["六月","六月"],PL:["Czerwiec","czerwca"],KK:["Маусым"],IT:["Giugno"],LV:["Jūnijs"]},dict.july={EN:["July","july"],RU:["Июль","июля"],FR:["Juillet","juillet"],DE:["Juli","Juli"],ES:["Julio","de julio"],PT:["Julho","de julho"],UK:["Липень","липня"],JA:["七月","七月"],ZH:["七月","七月"],PL:["Lipiec","lipca"],KK:["Шілде"],IT:["Luglio"],LV:["Jūlijs"]},dict.august={EN:["August","august"],RU:["Август","августа"],FR:["Août","août"],DE:["August","august"],ES:["Agosto","de agosto"],PT:["Agosto","de agosto"],UK:["Серпень","серпня"],JA:["八月","八月"],ZH:["八月","八月"],PL:["Sierpień","sierpnia"],KK:["Тамыз"],IT:["Agosto"],LV:["Augusts"]},dict.september={EN:["September","september"],RU:["Сентябрь","сентября"],FR:["Septembre","septembre"],DE:["September","september"],ES:["Septiembre","de septiembre"],PT:["Setembro","de setembro"],UK:["Вересень","вересня"],JA:["九月","九月"],ZH:["九月","九月"],PL:["Wrzesień","września"],KK:["Қыркүйек"],IT:["Settembre"],LV:["Septembris"]},dict.october={EN:["October","october"],RU:["Октябрь","октября"],FR:["Octobre","octobre"],DE:["Oktober","oktober"],ES:["Octubre","de octubre"],PT:["Outubro","de outubro"],UK:["Жовтень","жовтня"],JA:["十月","十月"],ZH:["十月","十月"],PL:["Październik","października"],KK:["Қазан"],IT:["Ottobre"],LV:["Oktobris"]},dict.november={EN:["November","november"],RU:["Ноябрь","ноября"],FR:["Novembre","novembre"],DE:["November","november"],ES:["Noviembre","de noviembre"],PT:["Novembro","de novembro"],UK:["Листопад","листопада"],JA:["十一月","十一月"],ZH:["十一月","十一月"],PL:["Listopad","listopada"],KK:["Қараша"],IT:["Novembre"],LV:["Novembris"]},dict.december={EN:["December","december"],RU:["Декабрь","декабря"],FR:["Décembre","décembre"],DE:["Dezember","dezember"],ES:["Diciembre","de diciembre"],PT:["Dezembro","de dezembro"],UK:["Грудень","грудня"],JA:["十二月","十二月"],ZH:["十二月","十二月"],PL:["Grudzień","grudnia"],KK:["Желтоқсан"],IT:["Dicembre"],LV:["Decembris"]};var lang=t_feed_returnLang(recid);return void 0!==dict[msg]?void 0!==dict[msg][lang]&&""!=dict[msg][lang]?dict[msg][lang]:dict[msg].EN:'Text not found "'+msg+'"'}function t_feed_returnLang(recid){var lang="EN";if(void 0!==window.tFeedPosts[recid]&&""!=window.tFeedPosts[recid].lang)lang=window.tFeedPosts[recid].lang.toUpperCase();else{lang=(window.navigator.userLanguage||window.navigator.language).toUpperCase().slice(0,2);var allrecords=document.getElementById("allrecords");if(allrecords){var projectLang=allrecords.getAttribute("data-tilda-project-lang");projectLang&&(lang=projectLang)}}return lang}function t_feed_onFuncLoad(funcName,okFunc,time){"function"==typeof window[funcName]?okFunc():setTimeout((function checkFuncExist(){if("function"!=typeof window[funcName]){if("complete"===document.readyState&&"function"!=typeof window[funcName])throw new Error(funcName+" is undefined");setTimeout(checkFuncExist,time||100)}else okFunc()}))}Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.msMatchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.webkitMatchesSelector||Element.prototype.oMatchesSelector),Element.prototype.closest||(Element.prototype.closest=function(s){for(var el=this;el&&1===el.nodeType;){if(Element.prototype.matches.call(el,s))return el;el=el.parentElement||el.parentNode}return null});